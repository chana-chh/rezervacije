{% extends "templates/app.twig" %} {% block stil %}
<link href="{{ base_url() }}/css/fullcalendar.css" rel="stylesheet" />
<link
  href="{{ base_url() }}/css/fullcalendar.print.css"
  rel="stylesheet"
  media="print"
/>
<style>
  .fc-day-grid-event:hover {
    background-color: #ffc107 !important;
    cursor: pointer;
  }
  a.fc-day-number {
    margin: 0.2rem;
    border-radius: 50%;
    text-decoration: none !important;
    width: 2rem;
    height: 2rem;
    line-height: 2rem;
    text-align: center;
    background-color: #6c757d;
    color: #ffffff;
  }
  a.fc-day-number:hover {
    background-color: #ffc107;
  }
</style>
{% endblock stil %} {% block naslov %}
<div class="row">
  <div class="col-lg-6">
    <h1><i class="fas fa-calendar-check"></i> Zakazivanje termina</h1>
  </div>
  <div class="col-lg-6 text-right">
    <ul class="list-inline lead pt-3 mb-0">
      <li class="list-inline-item ml-4">
        <i class="fas fa-calendar-plus text-danger"></i> Termin u pripremi
      </li>
      <li class="list-inline-item ml-4">
        <i class="fas fa-calendar-check text-success"></i> Zaključen termin
      </li>
    </ul>
  </div>
</div>
<hr />
<div class="row mb-2">
  <div class="col-lg-12" id="kalendar"></div>
</div>
{% endblock naslov %} {% block skripta %}
<script src="{{ base_url() }}/js/moment.min.js"></script>
<script src="{{ base_url() }}/js/fullcalendar.min.js"></script>
<script src="{{ base_url() }}/js/sr.js"></script>

<script>
  $(document).ready(function() {
    $("#kalendar").fullCalendar({
      themeSystem: "bootstrap4",
      customButtons: {
        buttonStampa: {
          text: "Štampaj",
          click: function() {
            window.print();
          }
        }
      },
      header: {
        left: "prev,next today buttonStampa",
        center: "title",
        right: "month"
      },
      defaultView: "month",
      weekends: true,
      height: 750,
      dayNames: [
        "nedelja",
        "ponedeljak",
        "utorak",
        "sreda",
        "četvrtak",
        "petak",
        "subota"
      ],
      dayNamesShort: [
        "nedelja",
        "ponedeljak",
        "utorak",
        "sreda",
        "četvrtak",
        "petak",
        "subota"
      ],
      monthNames: [
        "januar",
        "februar",
        "mart",
        "april",
        "maj",
        "jun",
        "jul",
        "avgust",
        "septembar",
        "oktobar",
        "novembar",
        "decembar"
      ],
      monthNamesShort: [
        "januar",
        "februar",
        "mart",
        "april",
        "maj",
        "jun",
        "jul",
        "avgust",
        "septembar",
        "oktobar",
        "novembar",
        "decembar"
      ],
      events: JSON.parse(`{{ data|raw }}`),
      eventBackgroundColor: "#f8f9fa",
      eventBorderColor: "#000000",
      eventTextColor: "#000000",
      eventClick: function(event, jsEvent, view) {
        const loc = "{{ path_for('termin.detalj.get') }}" + "/" + event.id;
        window.location = loc;
      },
      eventRender: function(event, element, view) {
        let title = element.find(".fc-title");
        const html = `
        <div class="clearfix">
          <div class="float-left text-wrap">
            ${event.start.format("HH:mm")} - ${event.end.format("HH:mm")}
          </div>
          <div class="float-right">
            <i class="${event.description}"></i>
          </div>
        </div>
        <div class="text-wrap">
          ${event.title}
        </div>
        `;
        title.html(html);
        element.addClass("p-1");
      },
      selectable: true,
      selectConstraint: {
        start: "00:00",
        end: "24:00"
      },
      dayClick: function(date, jsEvent, view) {
        $("#kalendar").select(date);
      },
      navLinks: true,
      navLinkDayClick: function(date, jsEvent) {
        let loc = `{{ url_termin_dodavanje }}/${date.format()}`;
        window.location = loc;
      },
      displayEventTime: false,
      showNonCurrentDates: false
    });

    var cal = $("#kalendar").fullCalendar("getCalendar");
    var d = window.location.href.substr(-10);
    var crtica = d.search("-");
    if (crtica !== -1) {
      var datum = cal.moment(d);
      cal.gotoDate(datum);
      cal.select(datum);
    }
  });
</script>
{% endblock skripta %}
