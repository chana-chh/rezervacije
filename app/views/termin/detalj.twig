{% extends "templates/app.twig" %} {% block stil %} {% endblock stil %} {% block
naslov %}
<div class="row">
  <div class="col">
    <h1><i class="fas fa-calendar-check"></i> Pregled termina</h1>
  </div>
  <div class="col text-right">
    <div class="btn-group btn-group-sm mt-3">
      <a href="#" class="btn btn-secondary" onclick="window.history.back();"
        ><i class="fas fa-chevron-circle-left"></i> Nazad</a
      >
      <a
        href="{{ path_for('termin.pregled.get', { datum: termin.datum }) }}"
        class="btn btn-secondary"
        ><i class="fas fa-arrow-alt-circle-left"></i> Termini</a
      >
      <a href="#" class="btn btn-success" id="zakljuci-termin">
        <i class="fas fa-check"></i> Zaključi
      </a>
      <a href="#" class="btn btn-warning"><i class="fas fa-edit"></i> Izmeni</a>
      <a
        href="#"
        class="btn btn-danger otvori-brisanje"
        data-toggle="modal"
        data-target="#brisanjeModal"
        ><i class="fas fa-trash"></i> Obriši</a
      >
    </div>
  </div>
</div>
<hr />

<div class="table-responsive">
  <table class="table">
    <tbody>
      <tr>
        <th class="w-10">Sala</th>
        <td class="w-90">{{ termin.sala().naziv }}</td>
      </tr>
      <tr>
        <th>Vreme</th>
        <td>
          {{ termin.datum|date() }} od {{ termin.pocetak|date("H:i") }} do
          {{ termin.kraj|date("H:i") }}
        </td>
      </tr>
      <tr>
        <th>Zaključen termin</th>
        <td>
          <div class="custom-control custom-checkbox">
            <input class="custom-control-input" type="checkbox" id="zauzet"{{
              termin.zauzet == 1 ? " checked" : ""
            }}
            disabled>
            <label class="custom-control-label" for="zauzet"
              ><strong></strong
            ></label>
          </div>
        </td>
      </tr>
      <tr>
        <th>Kratak opis</th>
        <td>{{ termin.opis }}</td>
      </tr>
      <tr>
        <th>Napomena</th>
        <td>{{ termin.napomena | nl2br }}</td>
      </tr>
      <tr>
        <th></th>
        <td></td>
      </tr>
    </tbody>
  </table>
</div>

{# Modal za brisanje termina #}
<div id="brisanjeModal" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-danger">Upozorenje!</h5>
        <button
          type="button"
          class="close"
          data-dismiss="modal"
          aria-label="Close"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <h6>Da li želite trajno da obrišete termin?</h6>
        <p class="text-danger">* Ova akcija je nepovratna!</p>
        <form
          action="{{ path_for('termin.brisanje.post') }}"
          method="POST"
          id="modal-forma-brisanje-tetmina"
        >
          {{ csrf | raw }}
          <input
            type="hidden"
            name="modal_termin_brisanje_id"
            id="modal-termin-brisanje-id"
          />
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-danger" id="modal-obrisi-termin">
          <i class="fas fa-trash-alt"></i> Obriši
        </button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">
          <i class="fas fa-ban"></i> Otkaži
        </button>
      </div>
    </div>
  </div>
</div>
{# Kraj modala za brisanje termina #}

<div class="row">
  <div class="col-lg-8">
    <h2>Ugovori za termin</h2>
  </div>
  <div class="col-lg-4 text-right pt-1">
    <a
      href="{{ path_for('termin.dodavanje.ugovor', { termin_id: termin.id }) }}"
      class="btn btn-outline-success btn-sm pretraga_div"
    >
      <i class="fas fa-plus-square"></i> Dodavanje ugovora
    </a>
  </div>
</div>

<div class="table-responsive">
  <table class="table">
    <thead class="thead-dark">
      <tr>
        <th class="w-5">#</th>
        <th class="w-10">Broj ugovora</th>
        <th class="w-10">Iznos</th>
        <th class="w-10">Kapara</th>
        <th class="w-15">Ime</th>
        <th class="w-10">Telefon</th>
        <th class="w-10">Email</th>
        <th class="w-10">Br mesta</th>
        <th class="w-10">Datum</th>
        <th class="w-10 text-right">
          <i class="fas fa-cogs text-warning"></i>
        </th>
      </tr>
    </thead>
    <tbody>
      {% for ugovor in termin.ugovori() %}
      <tr>
        <th>{{ ugovor.id }}</th>
        <td>{{ ugovor.broj_ugovora }}</td>
        <td class="text-info">
          <strong>{{ ugovor.iznos | number_format(2, '.', ',') }}</strong>
        </td>
        <td class="text-success">
          <strong>{{ ugovor.kapara | number_format(2, '.', ',') }}</strong>
        </td>
        <td>{{ ugovor.punoIme() }}</td>
        <td>{{ ugovor.telefon }}</td>
        <td>
          <a href="mailto:{{ ugovor.email }}">{{ ugovor.email }}</a>
        </td>
        <td>
          {{ ugovor.broj_mesta }} ({{ ugovor.broj_stolova }}/{{
            ugovor.broj_mesta_po_stolu
          }})
        </td>
        <td>{{ ugovor.datum|date() }}</td>
        <td class="text-right">
          <div class="btn-group btn-group-sm">
            <a
              class="btn btn-success"
              href="{{ path_for('ugovor.detalj', { id: ugovor.id }) }}"
              title="Detaljni pregled odabranog ugovora"
              ><i class="fas fa-eye"></i
            ></a>
            <a
              class="btn btn-warning"
              href="{{ path_for('ugovor.izmena.get', { id: ugovor.id }) }}"
              title="Izmena odabranog ugovora"
              ><i class="fas fa-edit"></i
            ></a>
            <button
              class="btn btn-danger otvori-brisanje"
              data-toggle="modal"
              data-target="#brisanjeModal"
              data-id="{{ ugovor.id }}"
              title="Brisanje odabranog ugovora"
            >
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock naslov %} {% block skripta %}
<script>
  $(document).ready(function() {
    $(".otvori-brisanje").on("click", function() {
      var id = "{{ termin.id }}";
      $("#modal-termin-brisanje-id").val(id);
    });
    $("#modal-obrisi-termin").on("click", function() {
      $("#modal-forma-brisanje-tetmina").submit();
    });
  });
</script>
{% endblock skripta %}
