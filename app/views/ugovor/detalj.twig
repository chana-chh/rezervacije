{% extends "templates/app.twig" %}
{% block stil %}

{% endblock stil %}
{% block naslov %}
<div class="row">
  <div class="col">
    <h1>
	  <i class="fas fa-file-signature text-secondary"></i>
	  Pregled ugovora
	  <strong class="text-info">{{ ugovor.broj_ugovora }}</strong>
    </h1>
  </div>
  <div class="col text-right pt-3">
    <div class="btn-group btn-group-sm">
      <button type="button" class="btn btn-secondary" onclick="window.history.back();" title="Povratak na prethodnu stranu"><i
          class="fas fa-chevron-circle-left"></i> Nazad</button>
      <a
        href="{{ path_for('termin.detalj.get', { id: ugovor.termin_id }) }}"
        class="btn btn-secondary"
        ><i class="fas fa-arrow-alt-circle-left"></i> Termin</a
      >
      <a
        href="{{ path_for('ugovor.uplate.lista', { id: ugovor.id }) }}"
        class="btn btn-success"
        ><i class="fas fa-money-bill"></i> Uplate</a
      >
    </div>
  </div>
</div>
<hr />
{% endblock naslov %}
{% block sadrzaj %}
<h4 class="text-primary">
	Termin: {{ugovor.termin().datum|date()}} od {{ ugovor.termin.pocetak|date("H:i") }} do {{ ugovor.termin.kraj|date("H:i") }}
</h4>
<table class="table mb-0">
	<tr>
		<th class="w-20">Meni</th>
		<td class="w-70">{{ ugovor.meni.naziv }}</td>
		<td class="w-10 text-right">
			<a
				class="btn btn-info btn-sm"
				href="{{ path_for('meni.detalj', { id: ugovor.meni.id }) }}"
				title="Detaljni pregled odabranog menija"
			>
				<i class="fas fa-eye"></i>
			</a

		</td>
	</tr>
	<tr>
		<th><strong>Ime i prezime</strong></th>
		<td>{{ ugovor.punoIme() }}</td>
		<td></td>
	</tr>
	<tr>
		<th><strong>Telefon</strong></th>
		<td>{{ ugovor.telefon }}</td>
		<td></td>
	</tr>
	<tr>
		<th><strong>E-mail</strong></th>
		<td>
			<a href="mailto:{{ ugovor.email }}">
				{{ ugovor.email }}</td>
			</a>
		<td></td>
	</tr>
	<tr>
		<th><strong>Cena</strong></th>
		<td>{{ ugovor.iznos|number_format }}</td>
		<td></td>
	</tr>
	<tr>
		<th><strong>Posebni zahtevi</strong></th>
		<td>{{ ugovor.posebni_zahtevi }}</td>
		<td></td>
	</tr>
	<tr>
		<th><strong>Napomena</strong></th>
		<td>{{ ugovor.napomena }}</td>
		<td></td>
	</tr>
</table>
<hr>
<div class="card border-dark mb-2">
    <div class="card-header">
		Detalji vezani za organizaciju
	</div>
    <div class="card-body text-dark">
      <div class="row">
      	<div class="col">
      		<table class="table table-sm table-striped mb-0" style="font-size: 0.875rem;">
      			<thead>
					<tr>
						<th class="w-5">#</th>
						<th class="w-20">Usluga</th>
						<th class="w-15 text-center">Status</th>
						<th class="w-30">Opis</th>
						<th class="w-30">Iznos</th>
					</tr>
    			</thead>
					<tbody>
					<tr>
						<th>1</th>
						<td>Muzika</td>
						<td class="text-center">
							{{ (ugovor.muzika_chk == 1) ? '<i class=\"fas fa-check text-success\"></i>' : '' }}
						</td>
						<td>{{ ugovor.muzika_opis }}</td>
						<td class="text-success">{{ ugovor.muzika_iznos | number_format(2, '.', ',') }}</td>
					</tr>
					<tr>
						<th>2</th>
						<td>Fotograf</td>
						<td class="text-center">
							{{ (ugovor.fotograf_chk == 1) ? '<i class=\"fas fa-check text-success\"></i>' : '' }}
						</td>
						<td>{{ ugovor.fotograf_opis }}</td>
						<td class="text-success">{{ ugovor.fotograf_iznos | number_format(2, '.', ',') }}</td>
					</tr>
					<tr>
						<th>3</th>
						<td>Torta</td>
						<td class="text-center">
							{{ (ugovor.torta_chk == 1) ? '<i class=\"fas fa-check text-success\"></i>' : '' }}
						</td>
						<td>{{ ugovor.torta_opis }}</td>
						<td class="text-success">{{ ugovor.torta_iznos | number_format(2, '.', ',') }}</td>
					</tr>
					<tr>
						<th>4</th>
						<td>Dekoracija</td>
						<td class="text-center">
							{{ (ugovor.dekoracija_chk == 1) ? '<i class=\"fas fa-check text-success\"></i>' : '' }}
						</td>
						<td>{{ ugovor.dekoracija_opis }}</td>
						<td class="text-success">{{ ugovor.dekoracija_iznos | number_format(2, '.', ',') }}</td>
					</tr>
					<tr>
						<th>5</th>
						<td>Kokteli</td>
						<td class="text-center">
							{{ (ugovor.kokteli_chk == 1) ? '<i class=\"fas fa-check text-success\"></i>' : '' }}
						</td>
						<td>{{ ugovor.kokteli_opis }}</td>
						<td class="text-success">{{ ugovor.kokteli_iznos | number_format(2, '.', ',') }}</td>
					</tr>
					<tr>
						<th>6</th>
						<td>Slatki sto</td>
						<td class="text-center">
							{{ (ugovor.slatki_sto_chk == 1) ? '<i class=\"fas fa-check text-success\"></i>' : '' }}
						</td>
						<td>{{ ugovor.slatki_sto_opis }}</td>
						<td class="text-success">{{ ugovor.slatki_sto_iznos | number_format(2, '.', ',') }}</td>
					</tr>
					<tr>
						<th>7</th>
						<td>Voćni sto</td>
						<td class="text-center">
							{{ (ugovor.vocni_sto_chk == 1) ? '<i class=\"fas fa-check text-success\"></i>' : '' }}
						</td>
						<td>{{ ugovor.vocni_sto_opis }}</td>
						<td class="text-success">{{ ugovor.vocni_sto_iznos | number_format(2, '.', ',') }}</td>
					</tr>
					</tbody>
  				</table>
  			</div>
  		</div>
	</div>
</div>
{% endblock sadrzaj %}
{% block traka %}
<div class="card border-dark mb-3">
	<div class="card-header text-primary">
		Dodavanje dokumenta
	</div>
	<div class="card-body text-dark">
		<form id="dokument-forma" action="{{ path_for('dokument.dodavanje') }}" method="POST" enctype="multipart/form-data">
			{{ csrf|raw }}
			<input type="hidden" id="ugovor_id" name="ugovor_id" value="{{ ugovor.id }}">
			<div class="form-row">
				<div class="col form-group">
					<label for="opis">Opis</label>
					<input type="text" class="form-control" name="opis" id="opis" required>
				</div>
			</div>
			<div class="form-row">
				<div class="form-group col-lg-6">
					<div class="custom-file">
						<input type="file" class="custom-file-input" id="dokument" name="dokument" required>
						<label id="file-label" class="custom-file-label" for="dokument" data-browse="Pronađi">Izaberi dokument</label>
					</div>
        		</div>
				<div class="col-lg-6 form-group text-right mb-0">
					<button type="submit" class="btn btn-primary">
						<i class="fas fa-plus-square"></i> Dodaj
					</button>
					<button type="reset" class="btn btn-secondary">
						<i class="fas fa-ban"></i> Otkaži
					</button>
				</div>
			</div>
		</form>
	</div>
</div>
<div class="card border-dark mb-3">
	<div class="card-header">
		Dokumenti
	</div>
	<div class="card-body text-dark">
		<table class="table table-sm table-striped">
          <thead class="thead-dark">
            <tr>
              <th class="w-10">#</th>
              <th class="w-70">Opis</th>
              <th class="w-20 text-right text-warning">
				  <i class="fas fa-cogs"></i>
			  </th>
            </tr>
          </thead>
          <tbody>
            {% for dok in ugovor.dokumenti() %}
            <tr>
              <th>{{ loop.index }}</th>
              <td>{{ dok.opis }}</td>
			  <td class="text-right">
				<div class="btn-group btn-group-sm">
					<a href="{{ dok.link }}" class="btn btn-success"  target="_blank">
						<i class="fas fa-eye"></i>
					</a>
					<a href="" class="btn btn-warning">
						<i class="fas fa-edit"></i>
					</a>
					<a href="" class="btn btn-danger">
						<i class="fas fa-trash"></i>
					</a>
				</div>
			  </td>
            </tr>
            {% endfor %}
		  </tbody>
        </table>
	</div>
</div>
{% endblock traka %}
{% block skripta %}
  <script>
    $(document).ready(function () {
      $(document).on('click', '.otvori-uplatu', function () {
       var id = $(this).data("id");
        $('#idUgovora').val(id);
	  });
	  $("#dokument").on("change", function(){
		$("#file-label").text(this.files[0].name);
	  })
    });
  </script>
{% endblock skripta %}
